CALL db2setcp
CALL db2 "CONNECT TO TESTDB USER db2admin USING XXXXXXXX"
CALL db2 "DROP TABLE EMBULK_INPUT"
CALL db2 "CREATE TABLE EMBULK_INPUT (ID INT NOT NULL, NUM DECIMAL(12,2), STR CHAR(8), VARSTR VARCHAR(8), DT DATE, TS TIMESTAMP, TS9 TIMESTAMP(9), PRIMARY KEY(ID))"
CALL db2 "INSERT INTO EMBULK_INPUT VALUES(1, 123.4, 'test1', 'TEST1', '2016-10-13', '2016-10-14 01:02:03', '2016-10-15 01:02:03.123456789')"
CALL db2 "INSERT INTO EMBULK_INPUT VALUES(2, 1234567890.12, 'test9999', 'TEST9999', '2016-12-31', '2016-12-31 23:59:59', '2016-12-31 23:59:59.999999999')"
CALL db2 "INSERT INTO EMBULK_INPUT VALUES(3, NULL, NULL, NULL, NULL, NULL, NULL)"

del data\test000.00.csv
CALL embulk run test.yml

echo "diff data/test_expected.csv data/test000.00.csv"
diff data/test_expected.csv data/test000.00.csv

IF "%ERRORLEVEL%" == "0" (ECHO "OK!") ELSE (ECHO "embulk-input-db2 FAILED!")
